{"version":3,"sources":["../src/index.js"],"names":["parse","build","mixed","options","workSheet","Object","keys","Sheets","map","name","sheet","data","utils","sheet_to_json","header","raw","worksheets","defaults","bookType","bookSST","type","workBook","forEach","worksheet","SheetNames","push","excelData","write","assign","Buffer"],"mappings":";;;;;QAKgBA,K,GAAAA,K;QAQAC,K,GAAAA,K;;AAZhB;;;;AACA;;AACA;;;;;;AAEO,SAASD,KAAT,CAAeE,KAAf,EAAoC;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AACzC,MAAMC,YAAY,eAAK,uBAASF,KAAT,IAAkB,UAAlB,GAA+B,MAApC,EAA4CA,KAA5C,EAAmDC,OAAnD,CAAlB;AACA,SAAOE,OAAOC,IAAP,CAAYF,UAAUG,MAAtB,EAA8BC,GAA9B,CAAkC,UAACC,IAAD,EAAU;AACjD,QAAMC,QAAQN,UAAUG,MAAV,CAAiBE,IAAjB,CAAd;AACA,WAAO,EAACA,UAAD,EAAOE,MAAM,eAAKC,KAAL,CAAWC,aAAX,CAAyBH,KAAzB,EAAgC,EAACI,QAAQ,CAAT,EAAYC,KAAK,IAAjB,EAAhC,CAAb,EAAP;AACD,GAHM,CAAP;AAID;;AAEM,SAASd,KAAT,CAAee,UAAf,EAAyC;AAAA,MAAdb,OAAc,uEAAJ,EAAI;;AAC9C,MAAMc,WAAW;AACfC,cAAU,MADK;AAEfC,aAAS,KAFM;AAGfC,UAAM;AAHS,GAAjB;AAKA,MAAMC,WAAW,wBAAjB;AACAL,aAAWM,OAAX,CAAmB,UAACC,SAAD,EAAe;AAChC,QAAMd,OAAOc,UAAUd,IAAV,IAAkB,OAA/B;AACA,QAAME,OAAO,mCAAqBY,UAAUZ,IAAV,IAAkB,EAAvC,EAA2CR,OAA3C,CAAb;AACAkB,aAASG,UAAT,CAAoBC,IAApB,CAAyBhB,IAAzB;AACAY,aAASd,MAAT,CAAgBE,IAAhB,IAAwBE,IAAxB;AACD,GALD;AAMA,MAAMe,YAAY,eAAKC,KAAL,CAAWN,QAAX,EAAqBhB,OAAOuB,MAAP,CAAc,EAAd,EAAkBX,QAAlB,EAA4Bd,OAA5B,CAArB,CAAlB;AACA,SAAOuB,qBAAqBG,MAArB,GAA8BH,SAA9B,GAA0C,IAAIG,MAAJ,CAAWH,SAAX,EAAsB,QAAtB,CAAjD;AACD;;kBAEc,EAAC1B,YAAD,EAAQC,YAAR,E","file":"index.js","sourcesContent":["\nimport XLSX from 'xlsx';\nimport {buildSheetFromMatrix, isString} from './helpers';\nimport Workbook from './workbook';\n\nexport function parse(mixed, options = {}) {\n  const workSheet = XLSX[isString(mixed) ? 'readFile' : 'read'](mixed, options);\n  return Object.keys(workSheet.Sheets).map((name) => {\n    const sheet = workSheet.Sheets[name];\n    return {name, data: XLSX.utils.sheet_to_json(sheet, {header: 1, raw: true})};\n  });\n}\n\nexport function build(worksheets, options = {}) {\n  const defaults = {\n    bookType: 'xlsx',\n    bookSST: false,\n    type: 'binary'\n  };\n  const workBook = new Workbook();\n  worksheets.forEach((worksheet) => {\n    const name = worksheet.name || 'Sheet';\n    const data = buildSheetFromMatrix(worksheet.data || [], options);\n    workBook.SheetNames.push(name);\n    workBook.Sheets[name] = data;\n  });\n  const excelData = XLSX.write(workBook, Object.assign({}, defaults, options));\n  return excelData instanceof Buffer ? excelData : new Buffer(excelData, 'binary');\n}\n\nexport default {parse, build};\n"]}
{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;QAKgB,K,GAAA,K;QAQA,K,GAAA,K;;AAZhB;;;;AACA;;AACA;;;;;;AAEO,SAAS,KAAT,CAAe,KAAf,EAAoC;AAAA,MAAd,OAAc,yDAAJ,EAAI;;AACzC,MAAM,YAAY,eAAK,uBAAS,KAAT,IAAkB,UAAlB,GAA+B,MAApC,EAA4C,KAA5C,EAAmD,OAAnD,CAAlB;AACA,SAAO,OAAO,IAAP,CAAY,UAAU,MAAtB,EAA8B,GAA9B,CAAkC,gBAAQ;AAC/C,QAAM,QAAQ,UAAU,MAAV,CAAiB,IAAjB,CAAd;AACA,WAAO,EAAC,UAAD,EAAO,MAAM,eAAK,KAAL,CAAW,aAAX,CAAyB,KAAzB,EAAgC,EAAC,QAAQ,CAAT,EAAY,KAAK,IAAjB,EAAhC,CAAb,EAAP;AACD,GAHM,CAAP;AAID;;AAEM,SAAS,KAAT,CAAe,UAAf,EAAyC;AAAA,MAAd,OAAc,yDAAJ,EAAI;;AAC9C,MAAM,WAAW;AACf,cAAU,MADK;AAEf,aAAS,KAFM;AAGf,UAAM;AAHS,GAAjB;AAKA,MAAM,WAAW,wBAAjB;AACA,aAAW,OAAX,CAAmB,qBAAa;AAC9B,QAAM,OAAO,UAAU,IAAV,IAAkB,OAA/B;AACA,QAAM,OAAO,mCAAqB,UAAU,IAAV,IAAkB,EAAvC,EAA2C,UAAU,OAAV,IAAqB,OAAhE,CAAb;AACA,aAAS,UAAT,CAAoB,IAApB,CAAyB,IAAzB;AACA,aAAS,MAAT,CAAgB,IAAhB,IAAwB,IAAxB;AACD,GALD;AAMA,MAAM,YAAY,eAAK,KAAL,CAAW,QAAX,EAAqB,OAAO,MAAP,CAAc,EAAd,EAAkB,QAAlB,EAA4B,OAA5B,CAArB,CAAlB;AACA,MAAI,CAAC,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;AACD,SAAO,IAAI,MAAJ,CAAW,SAAX,EAAsB,QAAtB,CAAP;AACD","file":"index.js","sourcesContent":["\nimport XLSX from 'xlsx';\nimport {buildSheetFromMatrix, isString} from './helpers';\nimport Workbook from './workbook';\n\nexport function parse(mixed, options = {}) {\n  const workSheet = XLSX[isString(mixed) ? 'readFile' : 'read'](mixed, options);\n  return Object.keys(workSheet.Sheets).map(name => {\n    const sheet = workSheet.Sheets[name];\n    return {name, data: XLSX.utils.sheet_to_json(sheet, {header: 1, raw: true})};\n  });\n}\n\nexport function build(worksheets, options = {}) {\n  const defaults = {\n    bookType: 'xlsx',\n    bookSST: false,\n    type: 'binary'\n  };\n  const workBook = new Workbook();\n  worksheets.forEach(worksheet => {\n    const name = worksheet.name || 'Sheet';\n    const data = buildSheetFromMatrix(worksheet.data || [], worksheet.options || options);\n    workBook.SheetNames.push(name);\n    workBook.Sheets[name] = data;\n  });\n  const excelData = XLSX.write(workBook, Object.assign({}, defaults, options));\n  if (!excelData) {\n    return false;\n  }\n  return new Buffer(excelData, 'binary');\n}\n"]}
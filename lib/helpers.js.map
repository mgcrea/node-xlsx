{"version":3,"sources":["../src/helpers.js"],"names":[],"mappings":"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","file":"helpers.js","sourcesContent":["import XLSX from 'xlsx';\n\nconst isBoolean = maybeBoolean => typeof maybeBoolean === 'boolean';\nconst isNumber = maybeNumber => typeof maybeNumber === 'number';\nconst isString = maybeString => typeof maybeString === 'string';\n\nconst originDate = new Date(Date.UTC(1899, 11, 30));\n\nconst buildExcelDate = (value, is1904) => {\n  const epoch = Date.parse(value + (is1904 ? 1462 : 0));\n  return (epoch - originDate) / (864e5);\n};\n\nconst buildSheetFromMatrix = (data, options = {}) => {\n  const workSheet = {};\n  const range = {s: {c: 1e7, r: 1e7}, e: {c: 0, r: 0}};\n  for (let R = 0; R !== data.length; ++R) {\n    for (let C = 0; C !== data[R].length; ++C) {\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n      if (data[R][C] === null) {\n        continue;\n      }\n      const cell = {v: data[R][C]};\n      const cellRef = XLSX.utils.encode_cell({c: C, r: R});\n      if (isNumber(cell.v)) {\n        cell.t = 'n';\n      } else if (isBoolean(cell.v)) {\n        cell.t = 'b';\n      } else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.v = buildExcelDate(cell.v);\n        cell.z = XLSX.SSF._table[14]; // eslint-disable-line no-underscore-dangle\n      } else {\n        cell.t = 's';\n      }\n      workSheet[cellRef] = cell;\n    }\n  }\n  if (range.s.c < 1e7) {\n    workSheet['!ref'] = XLSX.utils.encode_range(range);\n  }\n  if (options['!cols']) {\n    workSheet['!cols'] = options['!cols'];\n  }\n  if (options['!merges']) {\n    workSheet['!merges'] = options['!merges'];\n  }\n  return workSheet;\n};\n\nexport {buildSheetFromMatrix, isBoolean, isNumber, isString};\n"]}